#Corrected intensity - North south comparison
p1 <- t_storms %>%
mutate(Africa = Africa * C_Af[1], America = America * C_Am[1], Asia = Asia * C_As[1] * 1/2) %>%
full_join( ts_year_hours_NS %>%
index_by(hour_t) %>%
summarize( nor_NS = mean(nor*4) ), by = "hour_t") %>%
pivot_longer(c(Africa, America, Asia, nor_NS), names_to = "key", values_to ="value") %>%
ggplot( aes( x = hour_t, y = value, color = as.factor(key) ) ) +
geom_line( size = 1.2, alpha = 0.7 ) +
scale_colour_manual(values = c("springgreen", "darkolivegreen4",
"darkgreen", "darkblue"),
name= NULL,
breaks = c("Africa", "America", "Asia", "nor_NS"),
labels = c("Africa (left)", "America (left)", "Asia (left)",
"NS average (right)")
) +
scale_y_continuous(breaks = seq(0.0, 3, 0.5), limits = c(0.0, 3), name = NULL,
sec.axis = sec_axis(trans = ~./4, name = "Gaussian Ocurrence [%]")
) +
scale_x_continuous(breaks = seq(0,23,1), name = "Time [Hour]") +
theme(legend.position = "none",
#legend.position="top",
#legend.box = "horizontal",
axis.text.x = element_text(size = 7),
axis.title.y = element_text(size = 10)
)
#Corrected intensity - East West comparison
p2 <- t_storms %>%
mutate(Africa = Africa * C_Af[2], America = America * C_Am[2], Asia = Asia * C_As[2] * 1/2) %>%
full_join( ts_year_hours_EW %>%
index_by(hour_t) %>%
summarize( nor_EW = mean(nor*4) ), by = "hour_t") %>%
pivot_longer(c(Africa, America, Asia, nor_EW), names_to = "key", values_to ="value") %>%
ggplot( aes( x = hour_t, y = value, color = as.factor(key) ) ) +
geom_line( size = 1.2, alpha = 0.7 ) +
scale_colour_manual(values = c("springgreen", "darkolivegreen4",
"darkgreen", "lightskyblue"),
name= NULL,
breaks = c("Africa", "America", "Asia", "nor_EW"),
labels = c("Africa (left)", "America (left)", "Asia (left)",
"EW average (right)")
) +
scale_y_continuous(breaks = seq(0.0, 3, 0.5), limits = c(0.0, 3), name = "Intensity [AU]",
sec.axis = sec_axis(trans = ~./4, name = NULL)
) +
scale_x_continuous(breaks = seq(0,23,1), name = "Time [Hour]") +
theme(legend.position = "none",
#legend.position="top",
#legend.box = "horizontal",
axis.text.x = element_text(size = 7),
axis.title.y = element_text(size = 10)
)
prow <- plot_grid(p2, p1, align = "vh", nrow = 1)
??plot_grid
packages <- c("R.matlab", "tsibble", "cowplot")
# Install packages not yet installed
installed_packages <- packages %in% rownames(installed.packages())
if (any(installed_packages == FALSE)) {
install.packages(packages[!installed_packages])
}
# Packages loading""
invisible(lapply(packages, library, character.only = TRUE)) # GBM
prow <- plot_grid(p2, p1, align = "vh", nrow = 1)
legend_dist <- get_legend(p3 + theme(
legend.position="top",
legend.box = "horizontal"
)
)
plot_grid(legend_dist, prow, nrow = 2, rel_heights = c(0.1, 0.90))
p3 <- t_storms %>%
full_join( ts_year_hours_EW %>%
index_by(hour_t) %>%
summarize( nor_EW = mean(nor*4) ), by = "hour_t") %>%
full_join( ts_year_hours_NS %>%
index_by(hour_t) %>%
summarize( nor_NS = mean(nor*4) ), by = "hour_t") %>%
pivot_longer(c(Africa, America, Asia, nor_EW, nor_NS), names_to = "key", values_to ="value") %>%
ggplot( aes( x = hour_t, y = value, color = as.factor(key) ) ) +
geom_line( size = 1.2, alpha = 0.7 ) +
scale_colour_manual(values = c("springgreen", "darkolivegreen4",
"darkgreen", "lightskyblue", "darkblue"),
name= NULL,
breaks = c("Africa", "America", "Asia", "nor_EW", "nor_NS"),
labels = c("Africa (left)", "America (left)", "Asia (left)",
"EW average (right)", "NS average (right)")
) +
scale_y_continuous(breaks = seq(0.0, 3, 0.5), limits = c(0.0, 3), name = "Intensity [AU]",
sec.axis = sec_axis(trans = ~./4, name = "Gaussian Ocurrence [%]")
) +
scale_x_continuous(breaks = seq(0,23,1), name = "Time [Hour]") +
theme(legend.position="top",
legend.box = "horizontal",
axis.text.x = element_text(size = 10),
axis.title.y = element_text(size = 10)
)
legend_dist <- get_legend(p3 + theme(
legend.position="top",
legend.box = "horizontal"
)
)
plot_grid(legend_dist, prow, nrow = 2, rel_heights = c(0.1, 0.90))
#Corrected intensity - North south comparison
p1 <- t_storms %>%
mutate(Africa = Africa * C_Af[1], America = America * C_Am[1], Asia = Asia * C_As[1] ) %>%
full_join( ts_year_hours_NS %>%
index_by(hour_t) %>%
summarize( nor_NS = mean(nor*4) ), by = "hour_t") %>%
pivot_longer(c(Africa, America, Asia, nor_NS), names_to = "key", values_to ="value") %>%
ggplot( aes( x = hour_t, y = value, color = as.factor(key) ) ) +
geom_line( size = 1.2, alpha = 0.7 ) +
scale_colour_manual(values = c("springgreen", "darkolivegreen4",
"darkgreen", "darkblue"),
name= NULL,
breaks = c("Africa", "America", "Asia", "nor_NS"),
labels = c("Africa (left)", "America (left)", "Asia (left)",
"NS average (right)")
) +
scale_y_continuous(breaks = seq(0.0, 3, 0.5), limits = c(0.0, 3), name = NULL,
sec.axis = sec_axis(trans = ~./4, name = "Gaussian Ocurrence [%]")
) +
scale_x_continuous(breaks = seq(0,23,1), name = "Time [Hour]") +
theme(legend.position = "none",
#legend.position="top",
#legend.box = "horizontal",
axis.text.x = element_text(size = 7),
axis.title.y = element_text(size = 10)
)
#Corrected intensity - East West comparison
p2 <- t_storms %>%
mutate(Africa = Africa * C_Af[2], America = America * C_Am[2], Asia = Asia * C_As[2] * 1/2) %>%
full_join( ts_year_hours_EW %>%
index_by(hour_t) %>%
summarize( nor_EW = mean(nor*4) ), by = "hour_t") %>%
pivot_longer(c(Africa, America, Asia, nor_EW), names_to = "key", values_to ="value") %>%
ggplot( aes( x = hour_t, y = value, color = as.factor(key) ) ) +
geom_line( size = 1.2, alpha = 0.7 ) +
scale_colour_manual(values = c("springgreen", "darkolivegreen4",
"darkgreen", "lightskyblue"),
name= NULL,
breaks = c("Africa", "America", "Asia", "nor_EW"),
labels = c("Africa (left)", "America (left)", "Asia (left)",
"EW average (right)")
) +
scale_y_continuous(breaks = seq(0.0, 3, 0.5), limits = c(0.0, 3), name = "Intensity [AU]",
sec.axis = sec_axis(trans = ~./4, name = NULL)
) +
scale_x_continuous(breaks = seq(0,23,1), name = "Time [Hour]") +
theme(legend.position = "none",
#legend.position="top",
#legend.box = "horizontal",
axis.text.x = element_text(size = 7),
axis.title.y = element_text(size = 10)
)
prow <- plot_grid(p2, p1, align = "vh", nrow = 1)
legend_dist <- get_legend(p3 + theme(
legend.position="top",
legend.box = "horizontal"
)
)
plot_grid(legend_dist, prow, nrow = 2, rel_heights = c(0.1, 0.90))
#Corrected intensity - East West comparison
p2 <- t_storms %>%
mutate(Africa = Africa * C_Af[2], America = America * C_Am[2], Asia = Asia * C_As[2] * 1/2) %>%
full_join( ts_year_hours_EW %>%
index_by(hour_t) %>%
summarize( nor_EW = mean(nor*4) ), by = "hour_t") %>%
pivot_longer(c(Africa, America, Asia, nor_EW), names_to = "key", values_to ="value") %>%
ggplot( aes( x = hour_t, y = value, color = as.factor(key) ) ) +
geom_line( size = 1.2, alpha = 0.7 ) +
scale_colour_manual(values = c("springgreen", "darkolivegreen4",
"darkgreen", "lightskyblue"),
name= NULL,
breaks = c("Africa", "America", "Asia", "nor_EW"),
labels = c("Africa (left)", "America (left)", "Asia (left)",
"EW average (right)")
) +
scale_y_continuous(breaks = seq(0.0, 2.5, 0.5), limits = c(0.0, 3), name = "Intensity [AU]",
sec.axis = sec_axis(trans = ~./4, name = NULL)
) +
scale_x_continuous(breaks = seq(0,23,1), name = "Time [Hour]") +
theme(legend.position = "none",
#legend.position="top",
#legend.box = "horizontal",
axis.text.x = element_text(size = 7),
axis.title.y = element_text(size = 10)
)
prow <- plot_grid(p2, p1, align = "vh", nrow = 1)
legend_dist <- get_legend(p3 + theme(
legend.position="top",
legend.box = "horizontal"
)
)
plot_grid(legend_dist, prow, nrow = 2, rel_heights = c(0.1, 0.90))
#Corrected intensity - North south comparison
p1 <- t_storms %>%
mutate(Africa = Africa * C_Af[1], America = America * C_Am[1], Asia = Asia * C_As[1] ) %>%
full_join( ts_year_hours_NS %>%
index_by(hour_t) %>%
summarize( nor_NS = mean(nor*4) ), by = "hour_t") %>%
pivot_longer(c(Africa, America, Asia, nor_NS), names_to = "key", values_to ="value") %>%
ggplot( aes( x = hour_t, y = value, color = as.factor(key) ) ) +
geom_line( size = 1.2, alpha = 0.7 ) +
scale_colour_manual(values = c("springgreen", "darkolivegreen4",
"darkgreen", "darkblue"),
name= NULL,
breaks = c("Africa", "America", "Asia", "nor_NS"),
labels = c("Africa (left)", "America (left)", "Asia (left)",
"NS average (right)")
) +
scale_y_continuous(breaks = seq(0.0, 2.5, 0.5), limits = c(0.0, 3), name = NULL,
sec.axis = sec_axis(trans = ~./4, name = "Gaussian Ocurrence [%]")
) +
scale_x_continuous(breaks = seq(0,23,1), name = "Time [Hour]") +
theme(legend.position = "none",
#legend.position="top",
#legend.box = "horizontal",
axis.text.x = element_text(size = 7),
axis.title.y = element_text(size = 10)
)
#Corrected intensity - East West comparison
p2 <- t_storms %>%
mutate(Africa = Africa * C_Af[2], America = America * C_Am[2], Asia = Asia * C_As[2] * 1/2) %>%
full_join( ts_year_hours_EW %>%
index_by(hour_t) %>%
summarize( nor_EW = mean(nor*4) ), by = "hour_t") %>%
pivot_longer(c(Africa, America, Asia, nor_EW), names_to = "key", values_to ="value") %>%
ggplot( aes( x = hour_t, y = value, color = as.factor(key) ) ) +
geom_line( size = 1.2, alpha = 0.7 ) +
scale_colour_manual(values = c("springgreen", "darkolivegreen4",
"darkgreen", "lightskyblue"),
name= NULL,
breaks = c("Africa", "America", "Asia", "nor_EW"),
labels = c("Africa (left)", "America (left)", "Asia (left)",
"EW average (right)")
) +
scale_y_continuous(breaks = seq(0.0, 2.5, 0.5), limits = c(0.0, 3), name = "Intensity [AU]",
sec.axis = sec_axis(trans = ~./4, name = NULL)
) +
scale_x_continuous(breaks = seq(0,23,1), name = "Time [Hour]") +
theme(legend.position = "none",
#legend.position="top",
#legend.box = "horizontal",
axis.text.x = element_text(size = 7),
axis.title.y = element_text(size = 10)
)
prow <- plot_grid(p2, p1, align = "vh", nrow = 1)
legend_dist <- get_legend(p3 + theme(
legend.position="top",
legend.box = "horizontal"
)
)
plot_grid(legend_dist, prow, nrow = 2, rel_heights = c(0.1, 0.90))
#Corrected intensity - North south comparison
p1 <- t_storms %>%
mutate(Africa = Africa * C_Af[1], America = America * C_Am[1], Asia = Asia * C_As[1] ) %>%
full_join( ts_year_hours_NS %>%
index_by(hour_t) %>%
summarize( nor_NS = mean(nor*4) ), by = "hour_t") %>%
pivot_longer(c(Africa, America, Asia, nor_NS), names_to = "key", values_to ="value") %>%
ggplot( aes( x = hour_t, y = value, color = as.factor(key) ) ) +
geom_line( size = 1.2, alpha = 0.7 ) +
scale_colour_manual(values = c("springgreen", "darkolivegreen4",
"darkgreen", "darkblue"),
name= NULL,
breaks = c("Africa", "America", "Asia", "nor_NS"),
labels = c("Africa (left)", "America (left)", "Asia (left)",
"NS average (right)")
) +
scale_y_continuous(breaks = seq(0.0, 2.5, 0.5), limits = c(0.0, 2.5), name = NULL,
sec.axis = sec_axis(trans = ~./4, name = "Gaussian Ocurrence [%]")
) +
scale_x_continuous(breaks = seq(0,23,1), name = "Time [Hour]") +
theme(legend.position = "none",
#legend.position="top",
#legend.box = "horizontal",
axis.text.x = element_text(size = 7),
axis.title.y = element_text(size = 10)
)
#Corrected intensity - East West comparison
p2 <- t_storms %>%
mutate(Africa = Africa * C_Af[2], America = America * C_Am[2], Asia = Asia * C_As[2] * 1/2) %>%
full_join( ts_year_hours_EW %>%
index_by(hour_t) %>%
summarize( nor_EW = mean(nor*4) ), by = "hour_t") %>%
pivot_longer(c(Africa, America, Asia, nor_EW), names_to = "key", values_to ="value") %>%
ggplot( aes( x = hour_t, y = value, color = as.factor(key) ) ) +
geom_line( size = 1.2, alpha = 0.7 ) +
scale_colour_manual(values = c("springgreen", "darkolivegreen4",
"darkgreen", "lightskyblue"),
name= NULL,
breaks = c("Africa", "America", "Asia", "nor_EW"),
labels = c("Africa (left)", "America (left)", "Asia (left)",
"EW average (right)")
) +
scale_y_continuous(breaks = seq(0.0, 2.5, 0.5), limits = c(0.0, 2.5), name = "Intensity [AU]",
sec.axis = sec_axis(trans = ~./4, name = NULL)
) +
scale_x_continuous(breaks = seq(0,23,1), name = "Time [Hour]") +
theme(legend.position = "none",
#legend.position="top",
#legend.box = "horizontal",
axis.text.x = element_text(size = 7),
axis.title.y = element_text(size = 10)
)
prow <- plot_grid(p2, p1, align = "vh", nrow = 1)
legend_dist <- get_legend(p3 + theme(
legend.position="top",
legend.box = "horizontal"
)
)
plot_grid(legend_dist, prow, nrow = 2, rel_heights = c(0.1, 0.90))
save_fig("Intensity_comp_corr_2.png","double_wide")
p3 <- t_storms %>%
full_join( ts_year_hours_EW %>%
index_by(hour_t) %>%
summarize( nor_EW = mean(nor*4) ), by = "hour_t") %>%
full_join( ts_year_hours_NS %>%
index_by(hour_t) %>%
summarize( nor_NS = mean(nor*4) ), by = "hour_t") %>%
pivot_longer(c(Africa, America, Asia, nor_EW, nor_NS), names_to = "key", values_to ="value") %>%
ggplot( aes( x = hour_t, y = value, color = as.factor(key) ) ) +
geom_line( size = 1.2, alpha = 0.7 ) +
scale_colour_manual(values = c("springgreen", "darkolivegreen4",
"darkgreen", "lightskyblue", "darkblue"),
name= NULL,
breaks = c("Africa", "America", "Asia", "nor_EW", "nor_NS"),
labels = c("Africa (left)", "America (left)", "Asia (left)",
"EW average (right)", "NS average (right)")
) +
scale_y_continuous(breaks = seq(0.0, 3, 0.5), limits = c(0.0, 3), name = "Intensity [AU]",
sec.axis = sec_axis(trans = ~./4, name = "Gaussian Ocurrence [%]")
) +
scale_x_continuous(breaks = seq(0,23,1), name = "Time [Hour]") +
theme(legend.position="top",
legend.box = "horizontal",
legend.spacing.x = unit(1, 'cm')
axis.text.x = element_text(size = 10),
# spatial parameters of global thunderstorm centers (Schumann Resonance for Tyros).
t_sp = tibble(
Af = c(10, 10, 5, 28, 8, 8),
Am = c(4, 30, -15, -66, 12, -6),
As = c(2.5, 10, 0, 120, 20, 0)
)
#Monthly coordinates of storm centers
lat_Af = mean( -( t_sp$Af[1] + t_sp$Af[2]*cos((1:12+3)*pi/6) + t_sp$Af[3]*cos((1:12+3)*pi/3) ) )
long_Af = mean( t_sp$Af[4] + t_sp$Af[5]*cos((1:12+3)*pi/6) + t_sp$Af[6]*cos((1:12+3)*pi/3) )
lat_Am = mean( -( t_sp$Am[1] + t_sp$Am[2]*cos((1:12+3)*pi/6) + t_sp$Am[3]*cos((1:12+3)*pi/3) ) )
long_Am = mean( t_sp$Am[4] + t_sp$Am[5]*cos((1:12+3)*pi/6) + t_sp$Am[6]*cos((1:12+3)*pi/3) )
lat_As = mean( -( t_sp$As[1] + t_sp$As[2]*cos((1:12+3)*pi/6) + t_sp$As[3]*cos((1:12+3)*pi/3) ) )
long_As = mean( t_sp$As[4] + t_sp$As[5]*cos((1:12+3)*pi/6) + t_sp$As[6]*cos((1:12+3)*pi/3) )
C_Af = c( abs( sin(2.486) ), abs( cos(2.486) ) )
C_Am = c( abs( sin(4.363) ), abs( cos(4.363) ) )
C_As = c( abs( sin(1.239) ), abs( cos(1.239) ) )
#Corrected intensity - North south comparison
p1 <- t_storms %>%
mutate(Africa = Africa * C_Af[1], America = America * C_Am[1], Asia = Asia * C_As[1] ) %>%
full_join( ts_year_hours_NS %>%
index_by(hour_t) %>%
summarize( nor_NS = mean(nor*4) ), by = "hour_t") %>%
pivot_longer(c(Africa, America, Asia, nor_NS), names_to = "key", values_to ="value") %>%
ggplot( aes( x = hour_t, y = value, color = as.factor(key) ) ) +
geom_line( size = 1.2, alpha = 0.7 ) +
scale_colour_manual(values = c("springgreen", "darkolivegreen4",
"darkgreen", "darkblue"),
name= NULL,
breaks = c("Africa", "America", "Asia", "nor_NS"),
labels = c("Africa (left)", "America (left)", "Asia (left)",
"NS average (right)")
) +
scale_y_continuous(breaks = seq(0.0, 2.5, 0.5), limits = c(0.0, 2.5), name = NULL,
sec.axis = sec_axis(trans = ~./4, name = "Gaussian Ocurrence [%]")
) +
scale_x_continuous(breaks = seq(0,23,1), name = "Time [Hour]") +
theme(legend.position = "none",
#legend.position="top",
#legend.box = "horizontal",
axis.text.x = element_text(size = 7),
axis.title.y = element_text(size = 10)
)
#Corrected intensity - East West comparison
p2 <- t_storms %>%
mutate(Africa = Africa * C_Af[2], America = America * C_Am[2], Asia = Asia * C_As[2] * 1/2) %>%
full_join( ts_year_hours_EW %>%
index_by(hour_t) %>%
summarize( nor_EW = mean(nor*4) ), by = "hour_t") %>%
pivot_longer(c(Africa, America, Asia, nor_EW), names_to = "key", values_to ="value") %>%
ggplot( aes( x = hour_t, y = value, color = as.factor(key) ) ) +
geom_line( size = 1.2, alpha = 0.7 ) +
scale_colour_manual(values = c("springgreen", "darkolivegreen4",
"darkgreen", "lightskyblue"),
name= NULL,
breaks = c("Africa", "America", "Asia", "nor_EW"),
labels = c("Africa (left)", "America (left)", "Asia (left)",
"EW average (right)")
) +
scale_y_continuous(breaks = seq(0.0, 2.5, 0.5), limits = c(0.0, 2.5), name = "Intensity [AU]",
sec.axis = sec_axis(trans = ~./4, name = NULL)
) +
scale_x_continuous(breaks = seq(0,23,1), name = "Time [Hour]") +
theme(legend.position = "none",
#legend.position="top",
#legend.box = "horizontal",
axis.text.x = element_text(size = 7),
axis.title.y = element_text(size = 10)
)
prow <- plot_grid(p2, p1, align = "vh", nrow = 1)
legend_dist <- get_legend(p3 + theme(
legend.position="top",
legend.box = "horizontal"
)
)
plot_grid(legend_dist, prow, nrow = 2, rel_heights = c(0.1, 0.90))
p3 <- t_storms %>%
full_join( ts_year_hours_EW %>%
index_by(hour_t) %>%
summarize( nor_EW = mean(nor*4) ), by = "hour_t") %>%
full_join( ts_year_hours_NS %>%
index_by(hour_t) %>%
summarize( nor_NS = mean(nor*4) ), by = "hour_t") %>%
pivot_longer(c(Africa, America, Asia, nor_EW, nor_NS), names_to = "key", values_to ="value") %>%
ggplot( aes( x = hour_t, y = value, color = as.factor(key) ) ) +
geom_line( size = 1.2, alpha = 0.7 ) +
scale_colour_manual(values = c("springgreen", "darkolivegreen4",
"darkgreen", "lightskyblue", "darkblue"),
name= NULL,
breaks = c("Africa", "America", "Asia", "nor_EW", "nor_NS"),
labels = c("Africa (left)", "America (left)", "Asia (left)",
"EW average (right)", "NS average (right)")
) +
scale_y_continuous(breaks = seq(0.0, 3, 0.5), limits = c(0.0, 3), name = "Intensity [AU]",
sec.axis = sec_axis(trans = ~./4, name = "Gaussian Ocurrence [%]")
) +
scale_x_continuous(breaks = seq(0,23,1), name = "Time [Hour]") +
theme(legend.position="top",
legend.box = "horizontal",
legend.spacing.x = unit(1, 'cm'),
axis.text.x = element_text(size = 10),
axis.title.y = element_text(size = 10)
)
legend_dist <- get_legend(p3 + theme(
legend.position="top",
legend.box = "horizontal"
)
)
plot_grid(legend_dist, prow, nrow = 2, rel_heights = c(0.1, 0.90))
p3 <- t_storms %>%
full_join( ts_year_hours_EW %>%
index_by(hour_t) %>%
summarize( nor_EW = mean(nor*4) ), by = "hour_t") %>%
full_join( ts_year_hours_NS %>%
index_by(hour_t) %>%
summarize( nor_NS = mean(nor*4) ), by = "hour_t") %>%
pivot_longer(c(Africa, America, Asia, nor_EW, nor_NS), names_to = "key", values_to ="value") %>%
ggplot( aes( x = hour_t, y = value, color = as.factor(key) ) ) +
geom_line( size = 1.2, alpha = 0.7 ) +
scale_colour_manual(values = c("springgreen", "darkolivegreen4",
"darkgreen", "lightskyblue", "darkblue"),
name= NULL,
breaks = c("Africa", "America", "Asia", "nor_EW", "nor_NS"),
labels = c("Africa (left)", "America (left)", "Asia (left)",
"EW average (right)", "NS average (right)")
) +
scale_y_continuous(breaks = seq(0.0, 3, 0.5), limits = c(0.0, 3), name = "Intensity [AU]",
sec.axis = sec_axis(trans = ~./4, name = "Gaussian Ocurrence [%]")
) +
scale_x_continuous(breaks = seq(0,23,1), name = "Time [Hour]") +
theme(legend.position="top",
legend.box = "horizontal",
legend.spacing.x = unit(0.2, 'cm'),
axis.text.x = element_text(size = 10),
axis.title.y = element_text(size = 10)
)
legend_dist <- get_legend(p3 + theme(
legend.position="top",
legend.box = "horizontal"
)
)
plot_grid(legend_dist, prow, nrow = 2, rel_heights = c(0.1, 0.90))
p3 <- t_storms %>%
full_join( ts_year_hours_EW %>%
index_by(hour_t) %>%
summarize( nor_EW = mean(nor*4) ), by = "hour_t") %>%
full_join( ts_year_hours_NS %>%
index_by(hour_t) %>%
summarize( nor_NS = mean(nor*4) ), by = "hour_t") %>%
pivot_longer(c(Africa, America, Asia, nor_EW, nor_NS), names_to = "key", values_to ="value") %>%
ggplot( aes( x = hour_t, y = value, color = as.factor(key) ) ) +
geom_line( size = 1.2, alpha = 0.7 ) +
scale_colour_manual(values = c("springgreen", "darkolivegreen4",
"darkgreen", "lightskyblue", "darkblue"),
name= NULL,
breaks = c("Africa", "America", "Asia", "nor_EW", "nor_NS"),
labels = c("Africa (left)", "America (left)", "Asia (left)",
"EW average (right)", "NS average (right)")
) +
scale_y_continuous(breaks = seq(0.0, 3, 0.5), limits = c(0.0, 3), name = "Intensity [AU]",
sec.axis = sec_axis(trans = ~./4, name = "Gaussian Ocurrence [%]")
) +
scale_x_continuous(breaks = seq(0,23,1), name = "Time [Hour]") +
theme(legend.position="top",
legend.box = "horizontal",
legend.spacing.x = unit(0.5, 'cm'),
axis.text.x = element_text(size = 10),
axis.title.y = element_text(size = 10)
)
legend_dist <- get_legend(p3 + theme(
legend.position="top",
legend.box = "horizontal"
)
)
plot_grid(legend_dist, prow, nrow = 2, rel_heights = c(0.1, 0.90))
save_fig("Intensity_comp_corr_2.png", "double_wide")
